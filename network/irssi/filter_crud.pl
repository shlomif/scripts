# bearded unix curmudgeon mode

use Irssi;
use vars qw($VERSION %IRSSI);
$VERSION = "0.1";

sub filter_crud {
    my ( $server, $data, @rest ) = @_;
    # no colours and other such crud
    $data = Irssi::strip_codes($data);
    # strike emoji dead
    $data =~ s{
(?:\xc2[\xa9\xae]|
\xe2(?:\x80[\xbc]|
\x81[\x89]|
\x84[\xa2\xb9]|
\x86[\x94\x95\x96\x97\x98\x99\xa9\xaa]|
\x8c[\x9a\x9b\xa8]|
\x8f[\x8f\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb8\xb9\xba]|
\x93[\x82]|
\x96[\xaa\xab\xb6]|
\x97[\x80\xbb\xbc\xbd\xbe]|
\x98[\x80\x81\x82\x83\x84\x8e\x91\x94\x95\x98\x9d\xa0\xa2\xa3\xa6\xaa\xae\xaf\xb8\xb9\xba]|
\x99[\x80\x82\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\xa0\xa3\xa5\xa6\xa8\xbb\xbf]|
\x9a[\x92\x93\x94\x95\x96\x97\x99\x9b\x9c\xa0\xa1\xaa\xab\xb0\xb1\xbd\xbe]|
\x9b[\x84\x85\x88\x8e\x8f\x91\x93\x94\xa9\xaa\xb0\xb1\xb2\xb3\xb4\xb5\xb7\xb8\xb9\xba\xbd]|
\x9c[\x82\x85\x88\x89\x8a\x8b\x8c\x8d\x8f\x92\x94\x96\x9d\xa1\xa8\xb3\xb4]|
\x9d[\x84\x87\x8c\x8e\x93\x94\x95\x97\xa3\xa4]|
\x9e[\x95\x96\x97\xa1\xb0\xbf]|
\xa4[\xb4\xb5]|
\xac[\x85\x86\x87\x9b\x9c]|
\xad[\x90\x95])|
\xe3(?:\x80[\xb0\xbd]|
\x8a[\x97\x99])|
\xf0(?:\x9f(?:\x80[\x84]|
\x83[\x8f]|
\x85[\xb0\xb1\xbe\xbf]|
\x86[\x8e\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a]|
\x87[\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf]|
\x88[\x81\x82\x9a\xaf\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba]|
\x89[\x90\x91]|
\x8c[\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf]|
\x8d[\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf]|
\x8e[\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x96\x97\x99\x9a\x9b\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf]|
\x8f[\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb3\xb4\xb5\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf]|
\x90[\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf]|
\x91[\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf]|
\x92[\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf]|
\x93[\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbf]|
\x94[\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd]|
\x95[\x89\x8a\x8b\x8c\x8d\x8e\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xaf\xb0\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba]|
\x96[\x87\x8a\x8b\x8c\x8d\x90\x95\x96\xa4\xa5\xa8\xb1\xb2\xbc]|
\x97[\x82\x83\x84\x91\x92\x93\x9c\x9d\x9e\xa1\xa3\xa8\xaf\xb3\xba\xbb\xbc\xbd\xbe\xbf]|
\x98[\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf]|
\x99[\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f]|
\x9a[\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf]|
\x9b[\x80\x81\x82\x83\x84\x85\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\xa0\xa1\xa2\xa3\xa4\xa5\xa9\xab\xac\xb0\xb3\xb4\xb5\xb6\xb7\xb8]|
\xa4[\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbc\xbd\xbe]|
\xa5[\x80\x81\x82\x83\x84\x85\x87\x88\x89\x8a\x8b\x8c\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab]|
\xa6[\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97]|
\xa7[\x80\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6])))
(?:\xef\xb8[\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f])?
    }{_}gx;
    Irssi::signal_continue( $server, $data, @rest );
}

Irssi::signal_add( 'message public',  'filter_crud' );
Irssi::signal_add( 'message private', 'filter_crud' );
